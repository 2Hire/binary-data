const symbols = require('internal/symbols')

module.exports = select

function select(...whenTypes) {
  if (whenTypes.length === 0) {
    throw new TypeError('You should set at least one condition type.')
  }

  const result = {
    decode,
    [symbols.skip]: true
  }

  return result

  function decode(rstream, meta) {
    for (const when of whenTypes) {
      const probalyValue = when.decode(rstream, meta)

      if (when[symbols.skip] === true) {
        continue
      }

      result[symbols.skip] = false
      return probalyValue
    }
  }
}
